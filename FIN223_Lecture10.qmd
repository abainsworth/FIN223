---
title: "Term Structure of Interest Rates"
subtitle: "FIN 223 Lecture 10"
author: 
  name: "Andrew Ainsworth"
  affiliation: "University of Wollongong"
format: 
  revealjs:
    theme: FIN223_css_L2.scss
    html-table-processing: none
    chalkboard: 
      buttons: false
      theme: whiteboard
      boardmarker-width: 2
      transition: 1
      #src: FIN223_chalkboard_L4.json
execute: 
  eval: true
  echo: false
---

## Lecture outline


- What is the yield curve and why is it useful?
  - It is a barometer of the economy and future interest rates
- Term structure of interest rates
  - What is it?
  - How do we estimate it?
- How do we really price bonds?
  - We will see that each cash flow has its own discount rate
- Theories of the term structure
  - How can we predict future interest rates?

\

- Reading: BKM Ch 10.6 (pp. 312-318)


## What is the yield curve?

- Describes the relationship between yield and time to maturity at a given point in time across different fixed income securities
- Incorporates the views of market participants reflected in bond prices, and therefore, yields
- Different yield curve for different segments of the market (e.g. Treasury, AAA-rated corporate)
- The yield curve can provide an indication of the cost of debt for different maturities and issuers


## The yield curve

- The yield curve can many different shapes
- Upward-sloping yield curve
  - Indicates yields tend to increase with longer maturities
- Inverted yield curve
  - Occurs when short-term rates are higher than long term rates
- Flat yield curve 
  - Rates for short- and long-term debt are essentially the same
- Humped
  - Intermediate rates are the highest


## Australian government bond yields

![](yields.png){fig-align="center"}


## Australian government yield curves

![](yield_curves.png){fig-align="center"}


## Term spread: 10-year – 2-year yields

![](Term_Spread.png){fig-align="center"}


## YTM and bond pricing

```{r}
yield = 6
coupon = 8
years = 2
bondprice = round((1000*coupon/200)/(yield/200)*(1-(1+yield/200)^-(years*2)) + (1000/((1+yield/200)^(years*2))), digit = 2)
bondprice1 = (1000*coupon/200)/(yield/200)*(1-(1+yield/200)^-(years*2)) + (1000/((1+yield/200)^(years*2)))

y1 = 3.48
y2 = 3.98
y4 = 6.10
y3 = round((((1000*coupon/200)/((bondprice1  - (1000*coupon/200)/(1+y1/200) - (1000*coupon/200)/((1+y2/200)^2) - ((1000+1000*coupon/200)/((1+y4/200)^4)))))^(1/3)-1)*200, digit = 4)

```

- To date, we have used the YTM to price a bond’s cash flows

$$P = \frac{C}{(1+y)} + \frac{C}{(1+y)^2} + \frac{C}{(1+y)^3} + ... + \frac{F + C}{(1+y)^N}$$

- But, investors do not price a bond using the same discount rate ($y$) for each cash flow
- Each cash flow will have its own discount rate that is dependent on the time taken for the investor to receive the cash flow
- Consider a `r years`-year bond paying semi-annual coupons at `r coupon`% p.a. yielding `r yield`% p.a.
- This bond will have a price of $`r bondprice`


## YTM and bond pricing

- Pricing the bond using YTM

$$P = \frac{`r 10*coupon/2`}{(`r 1 + yield/200`)} + \frac{`r 10*coupon/2`}{(`r 1 + yield/200`)^`r 2*years/2`} + \frac{`r 10*coupon/2`}{(`r 1 + yield/200`)^`r 3*years/2`} + \frac{`r 1000 + 10*coupon/2`}{(`r 1 + yield/200`)^`r 4*years/2`}$$

- Pricing the bond using individual discount rates

$$P = \frac{`r 10*coupon/2`}{(`r 1 + y1/200`)} + \frac{`r 10*coupon/2`}{(`r 1 + y2/200`)^`r 2*years/2`} + \frac{`r 10*coupon/2`}{(`r round(1 + y3/200, digit=4)`)^`r 3*years/2`} + \frac{`r 1000 + 10*coupon/2`}{(`r 1 + y4/200`)^`r 4*years/2`}$$

- Both methods obtain a price of $`r bondprice`
- A coupon paying bond is equivalent to a package of zero coupon bonds
- Using the latter approach requires an understanding of the term structure of interest rates


## Term structure of interest rates

- The term structure of interest rates refers to the relationship between YTM and maturity of default-free zero coupon bonds (pure discount bond)
- Spot rate of interest
  - YTM of pure discount bond
- Spot curve
  - Relationship between spot rate and maturity
- Zero coupon securities: U.S. T-bills or strips of U.S. Treasury securities
- We will use a face value of $1 for convenience
- $z_j$ is the current price of a pure discount bond with a $1 face value
- $y_j$ is the spot rate of interest on a zero coupon bond with $j$ periods to maturity

$$z_j = \frac{1}{(1+y_j)^j}$$


## Term structure of interest rates

- If $j$ is in years then $z_3$ is the price of a three-year zero coupon bond
- The spot rate is found by re-arranging

$$y_j = (z_j)^{-\frac{1}{j}}$$

- Note: if using semi-annual compounding then the zero coupon bond price is

$$z_j = \frac{1}{(1 + \frac{y_j}{2})^{2j}}$$


## Bootstrapping the spot curve

- We can derive a spot curve to overcome the problem of limited zero coupon bonds being traded in the market
- To do this, we need to use a bootstrapping procedure to extract the spot rates for different maturities
- Consider the following three coupon paying bonds and their cash flows in each of the three years

\

```{r}
library(gt)
library(dplyr)

p1 = 997
p2 = 1005
p3 = 984
c11 = 1040
c21 = 50
c22 = 1050
c31 = 60
c32 = 60
c33 = 1060

y1 = c11/p1 - 1 
y2 = (c22 / (p2 - c21/(1+(c11/p1 - 1))))^(0.5)-1
y3 = (c33 / ((p3 - c31/(c11/p1)) - c32/(c22/(p2 - c21/(1+(c11/p1 - 1))))))^(1/3)-1

z1 = 1/(1+y1)
z2 = 1/(1+y2)^2
z3 = 1/(1+y3)^3

f0_12 = (1+y2)^2/(1+y1) - 1
f0_23 = (1+y3)^3/(1+y2)^2 - 1
f0_13 = ((1+y3)^3/(1+y1))^0.5 - 1

bp <- data.frame(bond = c(1, 2, 3), price = c(p1, p2, p3), year1 = c(c11, c21, c31),
                 year2 = c("", c22, c32), year3 = c("", "", c33))

bp_gt <- bp %>%
  gt(id = "bpid") %>%
  cols_label(bond = md("**Bond**"), price = md("**Price**"), year1 = md("**Year 1**"), year2 = md("**Year 2**"),
             year3 = md("**Year 3**")) %>%
  cols_align(align="center", columns = c(bond)) %>%
  cols_width(everything() ~ px(150)) %>%
  tab_options(table_body.hlines.style = "none") %>%
  opt_table_font(font = google_font(name = "Montserrat"), size = 30, color = "#0b1554") %>%
  tab_style(style = cell_borders(sides = c("t", "b"), color = "#0b1554", weight = px(2)),
    locations = cells_column_labels()) %>%
  tab_style(style = cell_borders(sides = c("b"), color = "#0b1554", weight = px(2)),
    locations = cells_body(columns = everything(), rows = length(bond)))

bp_gt

```


## Bootstrapping the spot curve

- We first use the price of the one-year coupon paying bond to ‘back out’ the one-year spot rate

$$
\begin{align}
P_1 &= \frac{1000+C_1}{(1+y_1)^1} \\
`r p1` &= \frac{`r c11`}{(1+y_1)} \\
y_1 &= \frac{`r c11`}{`r p1`} - 1 = `r round(100*y1, digit = 2)` \% \\
\end{align}
$$

- The implied one-year zero coupon bond price is

$$
\begin{align}
z_j &= \frac{1}{(1+y_j)^j} \\
z_1 &= \frac{1}{`r 1 + round(y1, digit = 4)`} = `r round(z1, digit = 4)`
\end{align}
$$


## Bootstrapping the spot curve

- We can substitute the spot rate into the calculation of the 2-year bond price

$$
\begin{align}
P_2 &= \frac{C_1}{(1+y_1)} + \frac{1000+C_2}{(1+y_2)^2} \\
`r p2` &= \frac{`r c21`}{`r round((1+(c11/p1 - 1)), digit = 4)`} + \frac{`r c22`}{(1+y_2)^2} \\
y_2 &= `r 100 * round(y2, digit=4)`\% \\
\therefore z_2 &= \frac{1}{`r round(1 + y2, digit=4)`^2} = `r round(z2, digit=4)`
\end{align}
$$

\

- We can continue with the same procedure to find the 3-year spot rate and zero coupon bond price
- $y_3$ = `r 100 * round((c33 / ((p3 - c31/(c11/p1)) - c32/(c22/(p2 - c21/(1+(c11/p1 - 1))))))^(1/3)-1, digit=4)` \% and $z_3$ = `r round(1/(c33 / ((p3 - c31/(c11/p1)) - c32/(c22/(p2 - c21/(1+(c11/p1 - 1)))))), digit=4)`


## Bootstrapping the spot curve

```{r}

spot <- data.frame(maturity = c(1, 2, 3), zeroprice = c(z1, z2, z3), spotrate = c(y1, y2, y3))

spot_gt <- spot %>%
  gt(id = "bpid") %>%
  cols_label(maturity = md("**Maturity**"), zeroprice = md("**Implied Zero Price**"), 
             spotrate = md("**Spot Rate of Interest**")) %>%
  fmt_number(columns = zeroprice, decimals = 4) %>%
  fmt_percent(columns = spotrate, decimals = 2) %>%
  cols_align_decimal(columns = c(zeroprice, spotrate)) %>%
  cols_align(align="center", columns = c(maturity, zeroprice, spotrate)) %>%
  cols_width(maturity ~ px(150), everything() ~ px(350)) %>%
  tab_options(table_body.hlines.style = "none") %>%
  opt_table_font(font = google_font(name = "Montserrat"), size = 30, color = "#0b1554") %>%
  tab_style(style = cell_borders(sides = c("t", "b"), color = "#0b1554", weight = px(2)),
    locations = cells_column_labels()) %>%
  tab_style(style = cell_borders(sides = c("b"), color = "#0b1554", weight = px(2)),
    locations = cells_body(columns = everything(), rows = length(spot)))

spot_gt

```

- Let’s price the 3-year bond using the spot rates

$$P_3 = \frac{`r c31`}{(`r round(1+y1,digit=4)`)} + \frac{`r c32`}{(`r round(1+y2,digit=4)`)^2} 
+ \frac{`r c33`}{(`r round(1+y3,digit=4)`)^3} = `r p3`$$

- Or we can use the implied zero coupon bond prices (they are discount factors)

$$
\begin{align}
P_3 &= `r c31` \times z_1 + `r c32` \times z_2 + `r c33` \times z_3 \\
    &= `r c31` \times `r round(z1, digit=4)` + `r c32` \times `r round(z2, digit=4)` + 
    `r c33` \times `r round(z3, digit=4)` \\
    &= `r p3`
\end{align}
$$

## Forward rates of interest

- Given a set of pure discount bond prices ($z_j$), we can calculate a set of forward rates defined on date $t$ as $f_t(j,k)$
- The forward rate can be locked in on date $t$ for a loan starting on date $j > t$ and maturing on date $k > j$
- This will remove investment uncertainty and risk

![](Fwd_rate.png)


## Forward rates of interest

- To preclude arbitrage, we need the following relationship between the forward rate, the j-period spot rate and the k-period spot rate

$$(1+y_j)^j \times (1+f_t(j,k))^{k-j} = (1+y_k)^k$$

- The forward rate is therefore

$$f_t(j,k) = \left[ \frac{(1+y_k)^k}{(1+y_j)^j} \right]^\frac{1}{k-j} - 1$$

- The forward rate at year 0 between year 1 and 2 is

$$f_0(1,2) = \left[ \frac{(1+y_2)^2}{(1+y_1)^1} \right]^\frac{1}{2-1} - 1$$


## Forward rates of interest

- Let’s calculate the forward rates from our previous example

```{r}

spot_gt

```

\

![](Fwd_rate2.png){fig-align="center"}


## Forward rates of interest

- Let’s calculate the forward rates

$$
\begin{align}
f_t(j,k) &= \left[ \frac{(1+y_k)^k}{(1+y_j)^j} \right]^\frac{1}{k-j} - 1 \\
f_0(1,2) &= \left[ \frac{(`r round(1+y2,digit=4)`)^2}{(`r round(1+y1,digit=4)`)} \right] - 1 
  = `r round(100*f0_12,digit=2)` \% \\
f_0(2,3) &= \left[ \frac{(`r round(1+y3,digit=4)`)^3}{(`r round(1+y2,digit=4)`)^2} \right] - 1 
  = `r round(100*f0_23,digit=2)` \% \\
f_0(1,3) &= \left[ \frac{(`r round(1+y3,digit=4)`)^3}{(`r round(1+y1,digit=4)`)} \right]^\frac{1}{(3-1)} - 1
  = `r round(100*f0_13,digit=2)` \% 
\end{align}
$$

- Note: we can also use the zero coupon prices to achieve the same results


## Theories of the term structure

- There exist numerous theories to explain the shape of the term structure
- We will review three of the theories
1. Expectations theory
1. Liquidity premium theory
1. Market segmentation theory


## Expectations theory

- Expectations theory asserts that forward rates are market expectations of future interest rates

$$f_t(j,k) = E_t[y(j,k)]$$

- Unbiased expectations means that there forecast errors ($\varepsilon$) have an average of zero

$$E_0[y(j,k)] = y(j,k) + \varepsilon$$

- If yield curve is upward sloping then interest rates are expected to rise in the future
- Implication of expectations theory is that bonds with different times to maturity are perfect substitutes
- It assumes investors will receive the same holding period return irrespective of bond choice
- Assumes risk neutrality of market participants and does not consider reinvestment risk


## Liquidity premium theory

- Corporations and governments prefer issuing long-term securities
- Investors prefer buying shorter term securities
- To entice investors to purchase bonds with maturities longer than their holding periods, bond issuers offer a liquidity premium 
- The forward rate comprises the expected future interest rate and liquidity premium ($LP$)

$$f_t(j,k) = E_t[y(j,k)] + E_t[LP(j,k)]$$

- The liquidity premium is related to the risk of uncertain selling prices when investors purchase bonds with maturities beyond their intended holding period
- Larger premium for longer maturity bonds


## Market segmentation theory

- Market segmentation theory asserts that the market for debt is segmented on the basis of the maturity preferences of different financial institutions and investors
- The yield curve changes as the supply and demand for funds within each maturity segment determines its prevailing interest rate
- If supply is greater than demand for short-term loans, short-term rates will be relatively low
- If at the same time, demand for long-term loans is higher than the available supply of funds, then long-term rates will move up
- In this situation, the yield curve will slope upward


## Conclusion

- The yield curve plots yields versus time to maturity
- Term structure of interest rates
  - We can bootstrap spot rates to price bonds 
  - Spot rates are interest rates on zero coupon bonds
  - We can extract forward rates
  - The principle of no arbitrage allows us to do this
- Theories of the term structure
  - Forward rates can potentially be used to estimated future spot rates
  - Different theories of the term structure can assist in extracting future spot rates from the term structure

